!function($){$.fn.selectopoly=function(){$(this).each(function(){return{_dom:{original:null,group:null,template:null},init:function(e){var t=this;t._dom.original=$(e),t._dom.group=$("<span />").addClass("selectopoly").addClass("repeater-group"),t._dom.group.insertAfter(t._dom.original).append(t._dom.original),t._dom.group.on("change","select[multiple]",function(){var e=t._getDummyValues()||[],r=t._dom.original.val()||[];for(var o in r){var i=r[o];-1===e.indexOf(i)&&e.push(i)}t._prepareTemplate(),t._dom.group.find(".form-group.repeater").remove();for(var a in e){t._addNewField().find("select").val(e[a]),t._updateRemovalButtons(),t._updateRequiredFlag()}t._addNewField()}),t._dom.group.on("change","select:not([multiple])",function(){t._updateFieldValues(t._dom.group),""!==t._dom.group.find("select:not([multiple]):last").val()&&(t._addNewField(),t._updateRemovalButtons(),t._updateRequiredFlag())}),t._dom.group.on("click",".repeater-remove",function(){$(this).parents(".form-group.repeater").first().remove(),t._updateFieldValues(),t._updateRemovalButtons(),t._updateRequiredFlag()}),t._dom.original.trigger("change").hide()},_prepareTemplate:function(){this._dom.template=$("<span />").addClass("form-group").addClass("repeater");var e=this._dom.original.clone().removeAttr("required multiple name id size style");e.find("option[selected]").removeAttr("selected"),e.find('option[value=""]').length<=0&&e.prepend('<option value="">Selectâ€¦</option>'),this._dom.template.append(e)},_getDummyValues:function(){var e=[];return this._dom.group.find(".form-group.repeater select").each(function(){var t=$(this).val();t.length>0&&e.push(t)}),e},_addNewField:function(){return this._dom.template.clone().appendTo(this._dom.group)},_updateFieldValues:function(){this._dom.group.find("select[multiple]").val(this._getDummyValues())},_updateRemovalButtons:function(){var e=this._dom.group.find(".form-group.repeater"),t=e.last();e.each(function(){$(this).is(t)?$(this).has(".repeater-remove").length>0&&$(this).find(".repeater-remove").remove():($(this).find('option[value=""]').remove(),0===$(this).has(".repeater-remove").length&&$(this).append('<a href="#" class="repeater-remove">Remove</a>'))})},_updateRequiredFlag:function(){var e=this._dom.group.find(".form-group.repeater select"),t=e.filter(function(){return""===$(this).val()});e.length===t.length?e.first().attr({required:"required"}):e.first().removeAttr("required")},_version:"1.0"}.init(this)})}}(jQuery),function(){var $=jQuery,e=document.getElementsByTagName("script");e[e.length-1].src.indexOf("?auto")>-1&&$().ready(function(){$("select[multiple]").selectopoly()})}();